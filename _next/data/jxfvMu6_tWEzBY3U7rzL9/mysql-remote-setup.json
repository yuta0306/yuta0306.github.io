{"pageProps":{"postData":{"contentHtml":"<p>現在conoHa VPSにMySQLの環境を作り外部からアクセスしようとしていました。しかし、ここで問題が...</p>\n<p>リモート接続するためのセットアップってどうやるん？<br>\nしかも何や。記事まねても全然うまくいかないやん...orz</p>\n<p>ってことなのですが、バージョン8にメジャーアップデートにあたり、コマンドの変更があったようなので共有します。</p>\n<p>で、今回はroot権限をどこからでも接続する権限を与えます。</p>\n<h2>sshにてリモートサーバにアクセス</h2>\n<p>まずははじめに、コマンドラインで<strong>ssh</strong>を使ってリモートサーバに入ります。今回はルートとして入ります。</p>\n<pre><code>$~ ssh root@xxx.xxx.x.xxx    <span>#@以降はアドレス</span>\nEnter password: **********\n~~ 以下略 ~~\n\n[root@xxx-xxx-x-xxx]<span># </span></code></pre>\n<p>このようにログイン先の情報とともに表示されます。</p>\n<h2>【本題】権限を与える</h2>\n<p>まずはMySQLを起動しまして、以下のコマンドを打ちます。</p>\n<pre><code>mysql<span>></span> <span>CREATE</span> <span>USER</span> <span>'root'</span>@<span>'%'</span> IDENTIFIED <span>BY</span> <span>'your-password'</span>;\nQuery OK, <span>0</span> <span>rows</span> affected (<span>0.01</span> sec)\n\nmysql<span>></span> <span>GRANT</span> <span>all</span> PRIVILEGES\n        <span>-</span><span>></span> <span>ON</span> <span>*</span>.<span>*</span> <span>TO</span> <span>'root'</span>@<span>'%'</span> \n        <span>-</span><span>></span> <span>WITH</span> <span>GRANT</span> OPTION;</code></pre>\n<p>まずは1つ目のコマンドでユーザーを作ります。(<strong>コレが8.0.x以降の仕様なのでドツボにハマるやつ!!</strong>)</p>\n<p>そして2つ目のコマンドにて、権限を付与してきます。ただ、今回は見易さのため複数行にしましたが、1行でも問題はないです。(大文字小文字もあまり気にしなくて良かったりもする)</p>\n<p>あと、'%'ってんはアクセスするIPアドレスを書くところであって、今回はどこからでもアクセスできる(どのPCからでも)を想定するので**'%'**を指定して全てを許可します。</p>\n<p>あと、***.***の部分はデータベースとテーブルの設定ですが、こちらも全てにアクセスができると想定してこちらにしています。任意のデータベースを許可したければ  '任意の名前'.*とでもすれば良いでしょう。</p>\n<p>一応コレで下準備は完了ってところですかね。</p>\n<p>基本的には問題ないのですが、僕が使ってみたconoHa VPSとかだと、ファイヤウォールの設定が必要なので今回は省略。</p>\n<p>ドツボにハマるのはきっとここなので注意。</p>\n<h2>実際にマイナーバージョンでのコマンド打ってみる</h2>\n<p>実際にマイナーバージョンでのコマンドを実行してみますか。(愚行)<br>\nあと小文字でやってみた。</p>\n<pre><code>mysql<span>></span> <span>grant</span> <span>all</span> privileges <span>on</span> \n        <span>-</span><span>></span> <span>*</span>.<span>*</span> <span>to</span> root@\"%\" identified <span>by</span> <span>'your-password'</span> \n        <span>-</span><span>></span> <span>with</span> <span>grant</span> option;\nERROR <span>1064</span> (<span>42000</span>): You have an error <span>in</span> your <span>SQL</span> syntax; <span>check</span> the manual that corresponds <span>to</span> your MySQL server version <span>for</span> the <span>right</span> syntax <span>to</span> use near <span>'identified by '</span>your<span>-</span>password<span>'\nwith grant option'</span> <span>at</span> line <span>2</span></code></pre>\n<p>まあこうなってわからないよね。SQL構文チェックしようねって言われるわけだけど、記事も少なかったし、ここはドツボにハマりかけるのかなと思います。</p>\n<h2>まとめ</h2>\n<p>ルートとして外部からどこでもどのデータベースのアクセスを許可するには以下のコマンドを打ちましょう。</p>\n<pre><code>mysql<span>></span> <span>CREATE</span> <span>USER</span> <span>'root'</span>@<span>'%'</span> IDENTIFIED <span>BY</span> <span>'your-password'</span>;\nQuery OK, <span>0</span> <span>rows</span> affected (<span>0.01</span> sec)\n\nmysql<span>></span> <span>GRANT</span> <span>all</span> PRIVILEGES\n        <span>-</span><span>></span> <span>ON</span> <span>*</span>.<span>*</span> <span>TO</span> <span>'root'</span>@<span>'%'</span> \n        <span>-</span><span>></span> <span>WITH</span> <span>GRANT</span> OPTION;</code></pre>\n<p>他にも外部サーバの設定のよって動かないことがあるので、それはまた紹介しますが。\n今回はバージョン8.0.xでの変更点に触れました。</p>\n<p>快適なデータベースライフを!!</p>\n","Title":"MySQL8.0.xでリモート接続のセットアップをする!","Date":"2020-07-18","Category":"SQL","Tags":"MySQL","Authors":"ゆうぼう","Slug":"mysql-remote-setup","Thumbnail":"/images/thumbnails/database.jpg","Description":"MySQLでリモート接続のためのセットアップを行いました。現環境はバージョン8.0.19なのですが、前回からのメジャーアップデートにて、コマンドが変わっており大変苦労したので備忘録として。かなりつまずきますので共有します。","Published":true},"categories":["Web","JavaScript","Competition","Cloud","Linux","Python","ML","Go","SQL"],"tags":["Apache","Appium","atmaCup","AWS","CentOS7","CentOS8","Colab","conda","CSS","ffmpeg","Flask","Go","Google Colaboratory","Heroku","HTML","JavaScript","JSON","Kaggle","Linux","Mac","make","map","MeCab","ML","MySQL","NLP","node.js","Pandas","Python","Pytorch","pytorch-lightning","Scikit-learn","Selenium","SISR","subprocess","Super-Resolution","tensorflow","Tkinter","zsh","オブジェクト指向","デコレータ","データ分析","特殊メソッド","超解像"]},"__N_SSG":true}