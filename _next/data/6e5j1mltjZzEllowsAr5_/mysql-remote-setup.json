{"pageProps":{"postData":{"contentHtml":"<p>現在conoHa VPSにMySQLの環境を作り外部からアクセスしようとしていました。しかし、ここで問題が...</p>\n<p>リモート接続するためのセットアップってどうやるん？<br>\nしかも何や。記事まねても全然うまくいかないやん...orz</p>\n<p>ってことなのですが、バージョン8にメジャーアップデートにあたり、コマンドの変更があったようなので共有します。</p>\n<p>で、今回はroot権限をどこからでも接続する権限を与えます。</p>\n<h2>sshにてリモートサーバにアクセス</h2>\n<p>まずははじめに、コマンドラインで<strong>ssh</strong>を使ってリモートサーバに入ります。今回はルートとして入ります。</p>\n<pre><code class=\"hljs language-bash\">$~ ssh root@xxx.xxx.x.xxx    <span class=\"hljs-comment\">#@以降はアドレス</span>\nEnter password: **********\n~~ 以下略 ~~\n\n[root@xxx-xxx-x-xxx]<span class=\"hljs-comment\"># </span></code></pre>\n<p>このようにログイン先の情報とともに表示されます。</p>\n<h2>【本題】権限を与える</h2>\n<p>まずはMySQLを起動しまして、以下のコマンドを打ちます。</p>\n<pre><code class=\"hljs language-sql\">mysql<span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">USER</span> <span class=\"hljs-string\">'root'</span>@<span class=\"hljs-string\">'%'</span> IDENTIFIED <span class=\"hljs-keyword\">BY</span> <span class=\"hljs-string\">'your-password'</span>;\nQuery OK, <span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">rows</span> affected (<span class=\"hljs-number\">0.01</span> sec)\n\nmysql<span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">GRANT</span> <span class=\"hljs-keyword\">all</span> PRIVILEGES\n        <span class=\"hljs-operator\">-</span><span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">ON</span> <span class=\"hljs-operator\">*</span>.<span class=\"hljs-operator\">*</span> <span class=\"hljs-keyword\">TO</span> <span class=\"hljs-string\">'root'</span>@<span class=\"hljs-string\">'%'</span> \n        <span class=\"hljs-operator\">-</span><span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">WITH</span> <span class=\"hljs-keyword\">GRANT</span> OPTION;</code></pre>\n<p>まずは1つ目のコマンドでユーザーを作ります。(<strong>コレが8.0.x以降の仕様なのでドツボにハマるやつ!!</strong>)</p>\n<p>そして2つ目のコマンドにて、権限を付与してきます。ただ、今回は見易さのため複数行にしましたが、1行でも問題はないです。(大文字小文字もあまり気にしなくて良かったりもする)</p>\n<p>あと、'%'ってんはアクセスするIPアドレスを書くところであって、今回はどこからでもアクセスできる(どのPCからでも)を想定するので**'%'**を指定して全てを許可します。</p>\n<p>あと、***.***の部分はデータベースとテーブルの設定ですが、こちらも全てにアクセスができると想定してこちらにしています。任意のデータベースを許可したければ  '任意の名前'.*とでもすれば良いでしょう。</p>\n<p>一応コレで下準備は完了ってところですかね。</p>\n<p>基本的には問題ないのですが、僕が使ってみたconoHa VPSとかだと、ファイヤウォールの設定が必要なので今回は省略。</p>\n<p>ドツボにハマるのはきっとここなので注意。</p>\n<h2>実際にマイナーバージョンでのコマンド打ってみる</h2>\n<p>実際にマイナーバージョンでのコマンドを実行してみますか。(愚行)<br>\nあと小文字でやってみた。</p>\n<pre><code class=\"hljs language-sql\">mysql<span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">grant</span> <span class=\"hljs-keyword\">all</span> privileges <span class=\"hljs-keyword\">on</span> \n        <span class=\"hljs-operator\">-</span><span class=\"hljs-operator\">></span> <span class=\"hljs-operator\">*</span>.<span class=\"hljs-operator\">*</span> <span class=\"hljs-keyword\">to</span> root@\"%\" identified <span class=\"hljs-keyword\">by</span> <span class=\"hljs-string\">'your-password'</span> \n        <span class=\"hljs-operator\">-</span><span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">with</span> <span class=\"hljs-keyword\">grant</span> option;\nERROR <span class=\"hljs-number\">1064</span> (<span class=\"hljs-number\">42000</span>): You have an error <span class=\"hljs-keyword\">in</span> your <span class=\"hljs-keyword\">SQL</span> syntax; <span class=\"hljs-keyword\">check</span> the manual that corresponds <span class=\"hljs-keyword\">to</span> your MySQL server version <span class=\"hljs-keyword\">for</span> the <span class=\"hljs-keyword\">right</span> syntax <span class=\"hljs-keyword\">to</span> use near <span class=\"hljs-string\">'identified by '</span>your<span class=\"hljs-operator\">-</span>password<span class=\"hljs-string\">'\nwith grant option'</span> <span class=\"hljs-keyword\">at</span> line <span class=\"hljs-number\">2</span></code></pre>\n<p>まあこうなってわからないよね。SQL構文チェックしようねって言われるわけだけど、記事も少なかったし、ここはドツボにハマりかけるのかなと思います。</p>\n<h2>まとめ</h2>\n<p>ルートとして外部からどこでもどのデータベースのアクセスを許可するには以下のコマンドを打ちましょう。</p>\n<pre><code class=\"hljs language-sql\">mysql<span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">USER</span> <span class=\"hljs-string\">'root'</span>@<span class=\"hljs-string\">'%'</span> IDENTIFIED <span class=\"hljs-keyword\">BY</span> <span class=\"hljs-string\">'your-password'</span>;\nQuery OK, <span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">rows</span> affected (<span class=\"hljs-number\">0.01</span> sec)\n\nmysql<span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">GRANT</span> <span class=\"hljs-keyword\">all</span> PRIVILEGES\n        <span class=\"hljs-operator\">-</span><span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">ON</span> <span class=\"hljs-operator\">*</span>.<span class=\"hljs-operator\">*</span> <span class=\"hljs-keyword\">TO</span> <span class=\"hljs-string\">'root'</span>@<span class=\"hljs-string\">'%'</span> \n        <span class=\"hljs-operator\">-</span><span class=\"hljs-operator\">></span> <span class=\"hljs-keyword\">WITH</span> <span class=\"hljs-keyword\">GRANT</span> OPTION;</code></pre>\n<p>他にも外部サーバの設定のよって動かないことがあるので、それはまた紹介しますが。\n今回はバージョン8.0.xでの変更点に触れました。</p>\n<p>快適なデータベースライフを!!</p>\n","Title":"MySQL8.0.xでリモート接続のセットアップをする!","Date":"2020-07-18","Category":"SQL","Tags":"MySQL","Authors":"ゆうぼう","Slug":"mysql-remote-setup","Thumbnail":"/images/thumbnails/database.jpg","Description":"MySQLでリモート接続のためのセットアップを行いました。現環境はバージョン8.0.19なのですが、前回からのメジャーアップデートにて、コマンドが変わっており大変苦労したので備忘録として。かなりつまずきますので共有します。","Published":true},"categories":["Web","JavaScript","Competition","Cloud","Linux","Python","ML","Go","SQL"],"tags":["Apache","Appium","atmaCup","AWS","CentOS7","CentOS8","conda","CSS","ffmpeg","Flask","Go","Google Colaboratory","HTML","JavaScript","JSON","Kaggle","Linux","Mac","make","map","MeCab","ML","MySQL","NLP","node.js","Pandas","Python","Scikit-learn","Selenium","subprocess","tensorflow","Tkinter","zsh","オブジェクト指向","デコレータ","データ分析","特殊メソッド"]},"__N_SSG":true}